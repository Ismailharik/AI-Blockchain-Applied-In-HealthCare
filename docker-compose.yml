version: '3.7'
services:
  #Start Mongo db
  mongodb:
    image: mongo:latest
    container_name: Mongodb
    ports:
      - "27017:27017"
  #Start consul server
  consul-server:
    image: consul:1.15
    container_name: consul-server
    ports:
      - "8500:8500"
      - "8600:8600/udp"
#    command: "agent -server -ui -node=server-1 -bsrcsrcootstrap-expect=1 -client=0.0.0.0"

  #End Consul server
#  gateway-service:
#    image: gateway-service
#    container_name: gateway-service
#    ports:
#      - "9999:9999"
#    environment:
#      - HOST_NAME=config-service
#      - CONSUL_PORT=8500
#      - CONSUL_HOST=consul-server
#      - SPRING_CONFIG_PORT=8888
#      - ZIPKIN_SERVER=http://zipkin-server:9411/api/v2/spans
#      - KC_HOST=keycloak
#      - KC_PORT=8080
#      - LOGGING_LEVEL_ORG_SPRINGFRAMEWORK_SECURITY= TRACE
  #    restart: on-failure
  #    depends_on:
  #      - consul-server
  #      - config-service
  #      - keycloak
  #    #    restart: always
  #    networks:
  #      - micros
  # instrumentation can send trace data to. Scribe is disabled by default.
  zipkin-server:
    image: openzipkin/zipkin
    container_name: zipkin-server
    environment:
      - STORAGE_TYPE=mem
      #Uncomment to enable debug logging
      - JAVA_OPTS=-Dlogging.level.zipkin=DEBUG -Dlogging.level.zipkin2=DEBUG
    ports:
      - "9411:9411"
  #Start Spring cloud config
#  config-service:
#    container_name: config-service
#    image: config-service
#    ports:
#      - "8888:8888"
#    environment:
#      - CONSUL_HOST=consul-server
#      - CONSUL_PORT=8500
